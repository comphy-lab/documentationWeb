<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<a id="" href="#"></a>
    <!-- Basic SEO Meta Tags -->
    <meta name="description" content="Computational fluid dynamics simulations using Basilisk C framework.">
    <meta name="author" content="Computational Multiphase Physics Laboratory">
    <meta name="keywords" content="fluid dynamics, CFD, Basilisk, multiphase flow, computational physics">
<a id="" href="#"></a>
    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:title" content="Test documentation: Lid driven cavity using dye injection - postProcess/getData-LidDriven.c">
    <meta property="og:description" content="Computational fluid dynamics simulations using Basilisk C framework.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://test.comphy-lab.org/postProcess/getData-LidDriven.c.html">
    <meta property="og:image" content="https://test.comphy-lab.org/assets/logos/CoMPhy-Lab.svg">
<a id="" href="#"></a>
    <!-- Canonical URL -->
    <link rel="canonical" href="https://test.comphy-lab.org/postProcess/getData-LidDriven.c.html">
<a id="" href="#"></a>
    <title>Test documentation: Lid driven cavity using dye injection - postProcess/getData-LidDriven.c</title>
<a id="" href="#"></a>
    <!-- Critical CSS -->
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --text-color: #333;
            --background-color: #fff;
            --code-background: #f5f5f5;
        }
<a id="" href="#"></a>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            margin: 0;
            padding: 0;
        }
<a id="" href="#"></a>
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }
<a id="" href="#"></a>
        pre, code {
            background: var(--code-background);
            border-radius: 4px;
            padding: 0.2em 0.4em;
        }
<a id="" href="#"></a>
        pre {
            padding: 1em;
            overflow-x: auto;
        }
    </style>
<a id="" href="#"></a>
    <!-- Preload Critical Resources -->
    <link rel="preload" href="//assets/css/styles.css" as="style">
    <link rel="preload" href="//assets/css/custom_styles.css" as="style">
    <link rel="preload" href="//assets/js/main.js" as="script">
<a id="" href="#"></a>
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="//assets/logos/CoMPhy-Lab.svg">
    <link rel="apple-touch-icon" href="//assets/logos/CoMPhy-Lab.svg">
<a id="" href="#"></a>
    <!-- Stylesheets -->
    <link rel="stylesheet" href="//assets/css/styles.css">
    <link rel="stylesheet" href="//assets/css/custom_styles.css">
    <link rel="stylesheet" href="//assets/css/command-palette.css">
    <link rel="stylesheet" href="//assets/css/vendor.css">
<a id="" href="#"></a>
    <!-- KaTeX for Math -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css">
<a id="" href="#"></a>
    <!-- jQuery and UI -->
    <script src="//js/jquery.min.js"></script>
    <script src="//js/jquery-ui.packed.js"></script>
    <script src="//js/plots.js"></script>
<a id="" href="#"></a>
    <!-- KaTeX -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js"></script>
<a id="" href="#"></a>
    <!-- Command Palette -->
    <script src="//assets/js/command-palette.js"></script>
    <script src="//assets/js/command-data.js"></script>
    <script src="//assets/js/shortcut-key.js"></script>
    <link href="../custom_styles.css" rel="stylesheet" type="text/css" />
    </head>
<body>
    <div class="container">
        <header class="site-header">
            <nav class="main-nav">
                <a href="//" class="logo">
                    <img src="//assets/logos/CoMPhy-Lab.svg" alt="CoMPhy-Lab Logo" height="40">
                </a>
                <div class="nav-links">
                    <a href="//Tutorial">Tutorial</a>
                    <a href="//src/INSTALL">Installation</a>
                    <a href="//Basilisk C">Basilisk C</a>
                    <a href="//src/README">Solvers</a>
                    <a href="//src/examples/README">Examples</a>
                </div>
            </nav>
        </header>
<a id="" href="#"></a>
        <main class="content">
<a id="" href="#"></a>
            <div class="page-content">
<a id="" href="#"></a>
                                <h1 class="page-title">postProcess/getData-LidDriven.c</h1>
<a id="" href="#"></a>
<a id="" href="#"></a>
                <h1 id="getting-data-from-simulation-snapshot">getting
                Data from simulation snapshot</h1>
                <h2 id="author">Author</h2>
                <p>Vatsal Sanjay Email: vatsalsy@comphy-lab.org CoMPhy
                Lab Physics of Fluids Department Last updated: Mar 8,
                2025</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb1-1"><span class="pp">#include </span><a href="http://basilisk.fr/src/utils.h" title="Link to Basilisk source for utils.h"><span class="im">"utils.h"</span></a></span>
<span id="cb1-2"><span class="pp">#include </span><a href="http://basilisk.fr/src/output.h" title="Link to Basilisk source for output.h"><span class="im">"output.h"</span></a></span>
<span id="cb1-3"><span class="pp">#include </span><a href="http://basilisk.fr/src/poisson.h" title="Link to Basilisk source for poisson.h"><span class="im">"poisson.h"</span></a></span>
<span id="cb1-4"></span>
<span id="cb1-5">vector u<span class="op">[];</span></span>
<span id="cb1-6"><span class="dt">char</span> filename<span class="op">[</span><span class="dv">1000</span><span class="op">];</span></span>
<span id="cb1-7"><span class="dt">int</span> nx<span class="op">,</span> ny<span class="op">,</span> len<span class="op">;</span></span>
<span id="cb1-8"><span class="dt">double</span> xmin<span class="op">,</span> ymin<span class="op">,</span> xmax<span class="op">,</span> ymax<span class="op">,</span> Deltax<span class="op">,</span> Deltay<span class="op">;</span></span>
<span id="cb1-9"></span>
<span id="cb1-10">scalar T<span class="op">[],</span> vel<span class="op">[],</span> psi<span class="op">[],</span> omega<span class="op">[];</span></span>
<span id="cb1-11">scalar <span class="op">*</span> list <span class="op">=</span> NULL<span class="op">;</span></span></code></pre></div></div>
                <p>Main entry point for processing fluid dynamics
                simulation data.</p>
                <p>This function validates the command-line arguments
                and initializes the simulation by reading in the file
                name and domain parameters (xmin, ymin, xmax, ymax, ny).
                It registers the necessary scalar fields (T, vel, psi),
                restores simulation data, applies Dirichlet boundary
                conditions for both the velocity and streamfunction,
                computes the velocity magnitude and vorticity, and then
                solves the Poisson equation to update the
                streamfunction. Finally, it calculates grid spacing and
                interpolates the scalar fields over the designated
                grid.</p>
                <h2 id="command-line-arguments">Command-line
                arguments:</h2>
                <ul>
                <li>arguments[0]: Program name.</li>
                <li>arguments[1]: Filename of the simulation
                snapshot.</li>
                <li>arguments[2]: Lower bound (xmin) of the
                x-domain.</li>
                <li>arguments[3]: Lower bound (ymin) of the
                y-domain.</li>
                <li>arguments[4]: Upper bound (xmax) of the
                x-domain.</li>
                <li>arguments[5]: Upper bound (ymax) of the
                y-domain.</li>
                <li>arguments[6]: Number of grid points along the
                y-direction (ny).</li>
                </ul>
                <h2 id="return">Return</h2>
                <p>Returns 1 if the argument validation fails;
                otherwise, the program proceeds with simulation
                processing.</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb2-1"><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">char</span> <span class="dt">const</span> <span class="op">*</span>arguments<span class="op">[])</span></span>
<span id="cb2-2"><span class="op">{</span></span>
<span id="cb2-3">  <span class="cf">if</span> <span class="op">(</span>a <span class="op">!=</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-4">    fprintf<span class="op">(</span>ferr<span class="op">,</span> <span class="st">&quot;Error: Expected 6 arguments</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb2-5">    fprintf<span class="op">(</span>ferr<span class="op">,</span> <span class="st">&quot;Usage: </span><span class="sc">%s</span><span class="st"> &lt;filename&gt; &lt;xmin&gt; &lt;ymin&gt; &lt;xmax&gt; &lt;ymax&gt; &lt;ny&gt;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> arguments<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb2-6">    <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb2-7">  <span class="op">}</span></span>
<span id="cb2-8"></span>
<span id="cb2-9">  sprintf <span class="op">(</span>filename<span class="op">,</span> <span class="st">&quot;</span><span class="sc">%s</span><span class="st">&quot;</span><span class="op">,</span> arguments<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb2-10">  xmin <span class="op">=</span> atof<span class="op">(</span>arguments<span class="op">[</span><span class="dv">2</span><span class="op">]);</span> ymin <span class="op">=</span> atof<span class="op">(</span>arguments<span class="op">[</span><span class="dv">3</span><span class="op">]);</span></span>
<span id="cb2-11">  xmax <span class="op">=</span> atof<span class="op">(</span>arguments<span class="op">[</span><span class="dv">4</span><span class="op">]);</span> ymax <span class="op">=</span> atof<span class="op">(</span>arguments<span class="op">[</span><span class="dv">5</span><span class="op">]);</span></span>
<span id="cb2-12">  ny <span class="op">=</span> atoi<span class="op">(</span>arguments<span class="op">[</span><span class="dv">6</span><span class="op">]);</span></span>
<span id="cb2-13"></span>
<span id="cb2-14">  list <span class="op">=</span> list_add <span class="op">(</span>list<span class="op">,</span> T<span class="op">);</span></span>
<span id="cb2-15">  list <span class="op">=</span> list_add <span class="op">(</span>list<span class="op">,</span> vel<span class="op">);</span></span>
<span id="cb2-16">  list <span class="op">=</span> list_add <span class="op">(</span>list<span class="op">,</span> psi<span class="op">);</span></span>
<span id="cb2-17"></span>
<span id="cb2-18">  <span class="co">/*</span></span>
<span id="cb2-19"><span class="co">  Actual run and codes!</span></span>
<span id="cb2-20"><span class="co">  */</span></span>
<span id="cb2-21"> restore <span class="op">(</span>file <span class="op">=</span> filename<span class="op">);</span></span>
<span id="cb2-22"></span>
<span id="cb2-23">  <span class="co">// Top moving wall</span></span>
<span id="cb2-24">  u<span class="op">.</span>t<span class="op">[</span>top<span class="op">]</span> <span class="op">=</span> dirichlet<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span></code></pre></div></div>
                <p>For the other no-slip boundaries this gives</p>
                <div class="code-block-container"><div class="code-block-container"><pre
                class="sourceCode c"><code class="sourceCode c"><span id="cb3-1">  u<span class="op">.</span>t<span class="op">[</span>bottom<span class="op">]</span> <span class="op">=</span> dirichlet<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb3-2">  u<span class="op">.</span>t<span class="op">[</span>left<span class="op">]</span>   <span class="op">=</span> dirichlet<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb3-3">  u<span class="op">.</span>t<span class="op">[</span>right<span class="op">]</span>  <span class="op">=</span> dirichlet<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb3-4">  <span class="co">// solve for the streamfunction</span></span>
<span id="cb3-5">  psi<span class="op">[</span>top<span class="op">]</span> <span class="op">=</span> dirichlet<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb3-6">  psi<span class="op">[</span>bottom<span class="op">]</span> <span class="op">=</span> dirichlet<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb3-7">  psi<span class="op">[</span>left<span class="op">]</span>   <span class="op">=</span> dirichlet<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb3-8">  psi<span class="op">[</span>right<span class="op">]</span>  <span class="op">=</span> dirichlet<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb3-9"></span>
<span id="cb3-10">  foreach<span class="op">()</span> <span class="op">{</span></span>
<span id="cb3-11">    vel<span class="op">[]</span> <span class="op">=</span> sqrt<span class="op">(</span>sq<span class="op">(</span>u<span class="op">.</span>x<span class="op">[])+</span>sq<span class="op">(</span>u<span class="op">.</span>y<span class="op">[]));</span></span>
<span id="cb3-12">  <span class="op">}</span></span>
<span id="cb3-13"></span>
<span id="cb3-14">  foreach<span class="op">()</span> <span class="op">{</span></span>
<span id="cb3-15">    omega<span class="op">[]</span> <span class="op">=</span> <span class="op">(</span>u<span class="op">.</span>y<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">-</span> u<span class="op">.</span>y<span class="op">[-</span><span class="dv">1</span><span class="op">]</span> <span class="op">-</span> u<span class="op">.</span>x<span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">]</span> <span class="op">+</span> u<span class="op">.</span>x<span class="op">[</span><span class="dv">0</span><span class="op">,-</span><span class="dv">1</span><span class="op">])/(</span><span class="fl">2.</span><span class="op">*</span>Delta<span class="op">);</span></span>
<span id="cb3-16">    psi<span class="op">[]</span> <span class="op">=</span> <span class="fl">0.</span><span class="op">;</span></span>
<span id="cb3-17">  <span class="op">}</span></span>
<span id="cb3-18">  poisson <span class="op">(</span>psi<span class="op">,</span> omega<span class="op">);</span></span>
<span id="cb3-19"></span>
<span id="cb3-20">  <span class="dt">FILE</span> <span class="op">*</span> fp <span class="op">=</span> ferr<span class="op">;</span></span>
<span id="cb3-21">  Deltay <span class="op">=</span> <span class="op">(</span><span class="dt">double</span><span class="op">)((</span>ymax<span class="op">-</span>ymin<span class="op">)/(</span>ny<span class="op">));</span></span>
<span id="cb3-22">  <span class="co">// fprintf(ferr, &quot;%g\n&quot;, Deltay);</span></span>
<span id="cb3-23">  nx <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">)((</span>xmax <span class="op">-</span> xmin<span class="op">)/</span>Deltay<span class="op">);</span></span>
<span id="cb3-24">  <span class="co">// fprintf(ferr, &quot;%d\n&quot;, nx);</span></span>
<span id="cb3-25">  Deltax <span class="op">=</span> <span class="op">(</span><span class="dt">double</span><span class="op">)((</span>xmax<span class="op">-</span>xmin<span class="op">)/(</span>nx<span class="op">));</span></span>
<span id="cb3-26">  <span class="co">// fprintf(ferr, &quot;%g\n&quot;, Deltax);</span></span>
<span id="cb3-27">  len <span class="op">=</span> list_len<span class="op">(</span>list<span class="op">);</span></span>
<span id="cb3-28">  <span class="co">// fprintf(ferr, &quot;%d\n&quot;, len);</span></span>
<span id="cb3-29">  <span class="dt">double</span> <span class="op">**</span> field <span class="op">=</span> <span class="op">(</span><span class="dt">double</span> <span class="op">**)</span> matrix_new <span class="op">(</span>nx<span class="op">,</span> ny<span class="op">+</span><span class="dv">1</span><span class="op">,</span> len<span class="op">*</span><span class="kw">sizeof</span><span class="op">(</span><span class="dt">double</span><span class="op">));</span></span>
<span id="cb3-30">  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> nx<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb3-31">    <span class="dt">double</span> x <span class="op">=</span> Deltax<span class="op">*(</span>i<span class="op">+</span><span class="fl">1.</span><span class="op">/</span><span class="dv">2</span><span class="op">)</span> <span class="op">+</span> xmin<span class="op">;</span></span>
<span id="cb3-32">    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> ny<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb3-33">      <span class="dt">double</span> y <span class="op">=</span> Deltay<span class="op">*(</span>j<span class="op">+</span><span class="fl">1.</span><span class="op">/</span><span class="dv">2</span><span class="op">)</span> <span class="op">+</span> ymin<span class="op">;</span></span>
<span id="cb3-34">      <span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-35">      <span class="cf">for</span> <span class="op">(</span>scalar s in list<span class="op">){</span></span>
<span id="cb3-36">        field<span class="op">[</span>i<span class="op">][</span>len<span class="op">*</span>j <span class="op">+</span> k<span class="op">++]</span> <span class="op">=</span> interpolate <span class="op">(</span>s<span class="op">,</span> x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb3-37">      <span class="op">}</span></span>
<span id="cb3-38">    <span class="op">}</span></span>
<span id="cb3-39">  <span class="op">}</span></span>
<span id="cb3-40"></span>
<span id="cb3-41">  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> nx<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb3-42">    <span class="dt">double</span> x <span class="op">=</span> Deltax<span class="op">*(</span>i<span class="op">+</span><span class="fl">1.</span><span class="op">/</span><span class="dv">2</span><span class="op">)</span> <span class="op">+</span> xmin<span class="op">;</span></span>
<span id="cb3-43">    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> ny<span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb3-44">      <span class="dt">double</span> y <span class="op">=</span> Deltay<span class="op">*(</span>j<span class="op">+</span><span class="fl">1.</span><span class="op">/</span><span class="dv">2</span><span class="op">)</span> <span class="op">+</span> ymin<span class="op">;</span></span>
<span id="cb3-45">      fprintf <span class="op">(</span>fp<span class="op">,</span> <span class="st">&quot;</span><span class="sc">%g</span><span class="st"> </span><span class="sc">%g</span><span class="st">&quot;</span><span class="op">,</span> x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb3-46">      <span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-47">      <span class="cf">for</span> <span class="op">(</span>scalar s in list<span class="op">){</span></span>
<span id="cb3-48">        fprintf <span class="op">(</span>fp<span class="op">,</span> <span class="st">&quot; </span><span class="sc">%g</span><span class="st">&quot;</span><span class="op">,</span> field<span class="op">[</span>i<span class="op">][</span>len<span class="op">*</span>j <span class="op">+</span> k<span class="op">++]);</span></span>
<span id="cb3-49">      <span class="op">}</span></span>
<span id="cb3-50">      fputc <span class="op">(</span><span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span><span class="op">,</span> fp<span class="op">);</span></span>
<span id="cb3-51">    <span class="op">}</span></span>
<span id="cb3-52">  <span class="op">}</span></span>
<span id="cb3-53">  fflush <span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb3-54">  fclose <span class="op">(</span>fp<span class="op">);</span></span>
<span id="cb3-55">  matrix_free <span class="op">(</span>field<span class="op">);</span></span>
<span id="cb3-56"></span>
<span id="cb3-57"><span class="op">}</span></span></code></pre></div></div>
            </div>
        </main>
<a id="" href="#"></a>
        <footer class="site-footer">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="//assets/logos/CoMPhy-Lab.svg" alt="CoMPhy-Lab Logo" height="30">
                </div>
                <div class="footer-links">
                    <a href="//Help">Help</a>
                    <a href="http://groups.google.com/d/forum/basilisk-fr">Forum</a>
                    <a href="//src/Contributing">Contribute</a>
                </div>
            </div>
        </footer>
    </div>
<a id="" href="#"></a>
    <!-- Command Palette Modal -->
    <div id="command-palette" class="command-palette">
        <div class="command-palette-content">
            <input type="text" id="command-input" placeholder="Type a command or search...">
            <div id="command-results"></div>
        </div>
    </div>
<a id="" href="#"></a>
    <!-- Main JavaScript -->
    <script src="//assets/js/main.js"></script>

    <script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function() {
        // Add copy button to each code block container
        const codeBlocks = document.querySelectorAll('.code-block-container pre');
        codeBlocks.forEach(function(codeBlock, index) {
            // Create button element
            const button = document.createElement('button');
            button.className = 'copy-button';
            button.textContent = 'Copy';
            button.setAttribute('aria-label', 'Copy code to clipboard');
            button.setAttribute('data-copy-state', 'copy');
            
            // Get the code block container (parent of the pre)
            const container = codeBlock.parentNode;
            
            // Add the button to the container
            container.appendChild(button);
            
            // Set up click event
            button.addEventListener('click', function() {
                // Create a textarea element to copy from
                const textarea = document.createElement('textarea');
                // Get the text content from the pre element (the actual code)
                textarea.value = codeBlock.textContent;
                document.body.appendChild(textarea);
                textarea.select();
                
                try {
                    // Execute copy command
                    document.execCommand('copy');
                    // Update button state
                    button.textContent = 'Copied!';
                    button.classList.add('copied');
                    
                    // Reset button state after 2 seconds
                    setTimeout(function() {
                        button.textContent = 'Copy';
                        button.classList.remove('copied');
                    }, 2000);
                } catch (err) {
                    console.error('Copy failed:', err);
                    button.textContent = 'Error!';
                }
                
                // Clean up
                document.body.removeChild(textarea);
            });
        });
    });
    </script>
        </body>
</html>
